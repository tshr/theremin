<!DOCTYPE html>
<html>
<head>
  <script src="theremin.js"></script>
  <style>
    input[type=range] {
      width: 100%;
    }
  </style>
</head>
<body>
  <!--
  <input id="theremin_tone_slider" type="range" name="points" min="1" max="1000">
  <input id="theremin_gain_slider" type="range" name="points" min="0" max="1" step="0.001">
  -->
  <a id="play" href="">play</a>
  <a id="pause" href="">pause</a>

  <script>
    window.onload = function() {

      var context = Theremin.setContext(new AudioContext());

      // Theremin
      // var oscillator = context.createOscillator();
      // var gain = context.createGain();
      // var theremin_tone_slider = document.getElementById("theremin_tone_slider");
      // var theremin_gain_slider = document.getElementById("theremin_gain_slider");

      // theremin_tone_slider.addEventListener('input', function() {
      //   oscillator.frequency.value = this.value;
      // }, true);

      // theremin_gain_slider.addEventListener('input', function() {
      //   gain.gain.value = this.value;
      // }, true);

      // oscillator.connect(gain);
      // gain.connect(context.destination);

      // oscillator.frequency.value = theremin_tone_slider.value;
      // gain.gain.value = theremin_gain_slider.value;

      // oscillator.start(0);

      // Wouldn't It Be Nice
      var total_duration = 0;
      var duration, source, play_start;

      document.getElementById("play").addEventListener('click', function(e) {
        e.preventDefault();
        if (!source) {
          source = Theremin.playBuffer(buffer, {loop: true, offset: (total_duration % buffer.duration)});
          play_start = context.currentTime;
        }
      }, true);

      document.getElementById("pause").addEventListener('click', function(e) {
        e.preventDefault();
        if (source) {
          source.stop();
          source = null;
          duration = context.currentTime - play_start;
          total_duration += duration;
        }
      }, true);

      Theremin.getBuffer("wouldnt_it_be_nice.mp3", window);
    };
  </script>
</body>
</html>